function [g, n] = gauss(f_name, a, b, acc)
disp('Gauss rule')
%GAUSS10(f_name,a,b) will integrate the function f_name over
%  the interval a<x<b using a 10 point Gauss quadrature
%  approximation.  The use is g = GAUSS10(f_name,a,b).
%======================================================
xe(:, :, 1) = [0.5773502691896257; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];
we(:, :, 1) = [1; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];

xe(:, :, 2) = [0.3399810435848563; 0.8611363115940526; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];
we(:, :, 2) = [0.6521451548625461; 0.3478548451374538; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];

xe(:, :, 3) = [-0.6612093864662645; 0.2386191860831969; 0.9324695142031521; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];
we(:, :, 3) = [0.3607615730481386; 0.4679139345726910; 	0.1713244923791704; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];

xe(:, :, 4) = [0.1834346424956498; 0.5255324099163290; 0.7966664774136267; 0.9602898564975363; 0; 0; 0; 0; 0; 0; 0; 0; 0];
we(:, :, 4) = [0.3626837833783620; 0.3137066458778873; 0.2223810344533745; 0.1012285362903763; 0; 0; 0; 0; 0; 0; 0; 0; 0];

xe(:, :, 5) = [0.1488743390;0.4333953941;0.6974095683;...
     0.8650633667;0.9739065285; 0; 0; 0; 0; 0; 0; 0; 0];
we(:, :, 5) = [0.2955242247;0.2692667193;0.2190863625;...
     0.1494513492;0.0666713443; 0; 0; 0; 0; 0; 0; 0; 0];
 
xe(:, :, 6) = [0.1252334085114689; 0.3678314989981802; 0.5873179542866175; 0.7699026741943047; 0.9041172563704749; 0.9815606342467192; 0; 0; 0; 0; 0; 0; 0]; 
we(:, :, 6) = [0.2491470458134028; 0.2334925365383548; 0.2031674267230659; 0.1600783285433462; 0.1069393259953184; 0.0471753363865118; 0; 0; 0; 0; 0; 0; 0];

xe(:, :, 7) = [0.1080549487073437; 0.3191123689278897; 0.5152486363581541; 0.6872929048116855; 0.8272013150697650; 0.9284348836635735; 0.9862838086968123; 0; 0; 0; 0; 0; 0];
we(:, :, 7) = [0.2152638534631578; 0.2051984637212956; 0.1855383974779378; 0.1572031671581935; 0.1215185706879032; 0.0801580871597602; 0.0351194603317519; 0; 0; 0; 0; 0; 0];

xe(:, :, 8) = [0.0950125098376374; 0.2816035507792589; 0.4580167776572274; 0.6178762444026438; 0.7554044083550030; 0.8656312023878318; 0.9445750230732326; 0.9894009349916499; 0; 0; 0; 0; 0];
we(:, :, 8) = [0.1894506104550685; 0.1826034150449236; 0.1691565193950025; 0.1495959888165767; 0.1246289712555339; 0.0951585116824928; 0.0622535239386479; 0.0271524594117541; 0; 0; 0; 0; 0];

xe(:, :, 9) = [0.0847750130417353; 0.2518862256915055; 0.4117511614628426; 0.5597708310739475; 0.6916870430603532; 0.8037049589725231; 0.8926024664975557; 0.9558239495713977; 0.9915651684209309; 0; 0; 0; 0];
we(:, :, 9) = [0.1691423829631436; 0.1642764837458327; 0.1546846751262652; 0.1406429146706507; 0.1225552067114785; 0.1009420441062872; 0.0764257302548891; 0.0497145488949698; 0.0216160135264833; 0; 0; 0; 0];

xe(:, :, 10) = [0.0765265211334973; 0.2277858511416451; 0.3737060887154195; 0.5108670019508271; 0.6360536807265150; 0.7463319064601508; 0.8391169718222188; 0.9122344282513259; 0.9639719272779138; 0.9931285991850949; 0; 0; 0];
we(:, :, 10) = [0.1527533871307258; 0.1491729864726037; 0.1420961093183820; 0.1316886384491766; 0.1181945319615184; 0.1019301198172404; 0.0832767415767048; 0.0626720483341091; 0.0406014298003869; 0.0176140071391521; 0; 0; 0];

xe(:, :, 11) = [0.0697392733197222; 0.2078604266882213; 0.3419358208920842; 0.4693558379867570; 0.5876404035069116; 0.6944872631866827; 0.7878168059792081; 0.8658125777203002; 0.9269567721871740; 0.9700604978354287; 0.9942945854823992; 0; 0];
we(:, :, 11) = [0.1392518728556320; 0.1365414983460152; 0.1311735047870624; 0.1232523768105124; 0.1129322960805392; 0.1004141444428810; 0.0859416062170677; 0.0697964684245205; 0.0522933351526833; 0.0337749015848142; 0.0146279952982722; 0; 0];

xe(:, :, 12) = [0.0640568928626056; 0.1911188674736163; 0.3150426796961634; 0.4337935076260451; 0.5454214713888396; 0.6480936519369755; 0.7401241915785544; 0.8200019859739029; 0.8864155270044011; 0.9382745520027328; 0.9747285559713095; 0.9951872199970213; 0];
we(:, :, 12) = [0.1279381953467522; 0.1258374563468283; 0.1216704729278034; 0.1155056680537256; 0.1074442701159656; 0.0976186521041139; 0.0861901615319533; 0.0733464814110803; 0.0592985849154368; 0.0442774388174198; 0.0285313886289337; 0.0123412297999872; 0];

xe(:, :, 13) = [0.0592300934293132; 0.1768588203568902; 0.2920048394859569; 0.4030517551234863; 0.5084407148245057; 0.6066922930176181; 0.6964272604199573; 0.7763859488206789; 0.8454459427884981; 0.9026378619843071; 0.9471590666617142; 0.9783854459564710; 0.9958857011456169];
we(:, :, 13) = [0.1183214152792623; 0.1166604434852966; 0.1133618165463197; 0.1084718405285766; 0.1020591610944254; 0.0942138003559141; 0.0850458943134852; 0.0746841497656597; 0.0632740463295748; 0.0509758252971478; 0.0379623832943628; 0.0244178510926319; 0.0105513726173430];

err = Inf;
n = 1;
q = 0.01*acc;
while(err>q)
t = .5*(b+a)+.5*(b-a)*[-flipud(xe(:, :, n));xe(:, :, n)];
W = [flipud(we(:, :, n));we(:, :, n)];
g = sum(W.*feval(f_name,t))*(b-a)/2;
err = abs(g-acc);
n = n+1;
end
n = 2*(n-1);

x = [0; -0.7745966692414834; 0.7745966692414834];
w = [0.8888888888888888; 0.5555555555555556; 0.5555555555555556];
t = .5*(b+a)+.5*(b-a)*x;
g = sum(w.*feval(f_name,t))*(b-a)/2;
err = abs(abs(g)-abs(acc));
if(err<=0.01)
    n = 3;
end

g = 5*1500*g;